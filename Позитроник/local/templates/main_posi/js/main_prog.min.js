function positronika_add2basket(a){if(a>0){$("#modalBuy .modal-body").find(".move_basket").addClass("hidden");$("#modalBuy").modal();$("#modalBuy .modal-content").preloader("start").find(".modal-title").html("Товар добавляется в корзину");$.ajax({type:"POST",dataType:"json",url:"/ajax/addProduct.php",data:{id:a,action:"add"},success:function(b){$("#modalBuy .modal-content").find(".modal-title").html("Товар добавлен в корзину");$("#modalBuy .btn-primary").show();if($(".js_add2wishlist[data-id="+a+"] span").size()>0&&$(".js_add2wishlist[data-id="+a+"] span").hasClass("active")){$("#modalBuy .modal-body .move_basket").removeClass("hidden")}$(".js_add2basket[data-id="+a+"]").addClass("btn-primary").removeClass("btn-default").text("В КОРЗИНЕ").removeClass("js_add2basket").addClass("js_go2cart");$(".js_add2wishlist[data-id="+a+"] span").removeClass("active");$("#cart_informer").html(b.basket)}}).fail(function(){$("#modalBuy .modal-content").find(".modal-title").html("Товар не добавлен в корзину");$("#modalBuy .btn-primary").hide()}).always(function(){$("#modalBuy .modal-content").preloader("stop")})}}function positronika_add2wishlist(e){if(e>0){var b=(!$(".js_add2wishlist[data-id="+e+"] span").hasClass("active"))?"add":"remove",d=(b=="add")?"Товар добавляется в список желаний":"Товар удаляется из списка желаний",c=(b=="add")?"Товар добавлен в список желаний":"Товар удален из списка желаний",a=(b=="add")?"Товар не добавлен в список желаний":"Товар не удален из списка желаний";$("#modalFavorit .modal-body").addClass("hidden").find(".move_wish").addClass("hidden");$("#modalFavorit").modal();$("#modalFavorit .modal-content").preloader("start").find(".modal-title").html(d);$.ajax({type:"POST",dataType:"json",url:"/ajax/addProduct.php",data:{id:e,delay:1,action:b},success:function(f){$("#modalFavorit .modal-content").find(".modal-title").html(c);$("#modalFavorit .btn-primary").show();if(b=="add"){$("#modalFavorit .modal-body").removeClass("hidden");$(".js_add2wishlist[data-id="+e+"] span").addClass("active")}else{$(".js_add2wishlist[data-id="+e+"] span").removeClass("active");$("#modalFavorit .modal-body").addClass("hidden")}if($(".js_go2cart[data-id="+e+"]").size()>0&&$(".js_go2cart[data-id="+e+"]").hasClass("btn-primary")){$("#modalFavorit .modal-body .move_wish").removeClass("hidden")}$(".js_go2cart[data-id="+e+"]").removeClass("btn-primary").addClass("btn-default").text("КУПИТЬ").removeClass("js_go2cart").addClass("js_add2basket");$("#cart_informer").html(f.basket)}}).fail(function(){$("#modalFavorit .modal-content").find(".modal-title").html(a);$("#modalFavorit .btn-primary").hide()}).always(function(){$("#modalFavorit .modal-content").preloader("stop")})}}function positronika_add2compare(f){if(f>0){var b=($(".js_add2compare[data-id="+f+"] span").hasClass("icon-product-add-comparison"))?"add":"remove",e=(b=="add")?"Товар добавляется в сравнение":"Товар удаляется из сравнения",d=(b=="add")?"Товар добавлен в сравнение":"Товар удален из сравнения",a=(b=="add")?"Товар не добавлен в сравнение":"Товар не удален из сравнения",c=(b=="remove"&&$(".js_add2compare[data-id="+f+"] span.glyphicon").data("remove")=="Y");if(!c){$("#modalCompare").modal()}$("#modalCompare .modal-content").preloader("start").find(".modal-title").html(e);if($(".operate a.btn:eq(1)").size()>0){$("#modalCompare .modal-footer .btn-primary").click(function(){location.href=$(".operate a.btn:eq(1)").attr("href");return false})}$.ajax({type:"POST",dataType:"json",url:"/ajax/actionCompare.php",data:{id:f,action:b},success:function(g){$("#modalCompare .modal-content").find(".modal-title").html(d);$("#modalCompare .btn-primary").show();if(b=="add"){$(".js_add2compare[data-id="+f+"] span.glyphicon").removeClass("icon-product-add-comparison").addClass("icon-product-remove-comparison")}else{$(".js_add2compare[data-id="+f+"] span.glyphicon").removeClass("icon-product-remove-comparison").addClass("icon-product-add-comparison")}$("#compare_count").text(g.count);if(c){location.reload()}}}).fail(function(){$("#modalCompare .modal-content").find(".modal-title").html(a);$("#modalCompare .btn-primary").hide()}).always(function(){$("#modalCompare .modal-content").preloader("stop")})}}loadFormReview=function(a){var c=$("#review-form"),b=(a&&a.nodeName=="FORM")?$(a).serialize():{id:c.data("id")};if((a&&a.nodeName=="FORM")||c.find(".js_data").html()==""){c.css({position:"relative"}).preloader("start");$.ajax({type:"POST",dataType:"html",url:"/ajax/opinionsForm.php",data:b,success:function(d){c.find(".js_data").html(d)}}).always(function(){c.preloader("stop")})}};function checkBeforeRedirect(){var a=window.location.href.split("?")[0];if(a.indexOf("/order/")>-1){if(confirm("В выбранном городе находится наш магазин. Перейти на сайт магазина?")){return true}else{$("#city_change").popover("hide");$("#city_change1").popover("hide");return false}}}$(document).ready(function(){$(document).on("click",".js_print",function(a){a.preventDefault();window.print();return false});$(document).on("click",".js_add2basket",function(a){a.preventDefault();;positronika_add2basket($(this).data("id"));return false});$(document).on("click",".js_go2cart",function(a){window.location.href=window.location.protocol+"//"+window.location.hostname+"/cart/";return false});$(document).on("click",".js_add2wishlist",function(a){a.preventDefault();positronika_add2wishlist($(this).data("id"));return false});$(document).on("click",".js_add2compare",function(a){a.preventDefault();positronika_add2compare($(this).data("id"));return false});$(document).on("click","#reloadCaptcha",function(){$.getJSON("/ajax/reloadCaptcha.php",function(a){$("#captchaImg").attr("src","/bitrix/tools/captcha.php?captcha_code="+a);$("#sidCaptcha").val(a)});return false})});